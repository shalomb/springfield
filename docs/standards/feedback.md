# Feedback Standard

This document defines the structure and protocol for quality reviews generated by the Quality Agent (Bart). 
The goal is to produce **actionable**, **structured**, and **prioritized** feedback that the Planning Agent (Lisa) can parse to update the roadmap (`PLAN.md`) and task list (`TODO.md`) without ambiguity.

---

## üìã The `FEEDBACK.md` Template

Bart must use the following structure when generating `FEEDBACK.md`.

```markdown
# FEEDBACK: [Feature Name / Context]
**Reviewer:** @Bart | **Date:** YYYY-MM-DD | **Target:** [Commit SHA / Branch Name]

## üö® Status: [BLOCKED | CONDITIONAL | APPROVED]
> **Lisa's Directive:** [Stop & Fix Immediately | Schedule Fixes | Proceed to Merge]

## üõë Critical Blockers (Immediate Action)
*Defects that cause data loss, security breaches, crashes, or total failure. 
Lisa must add these to the top of `TODO.md` immediately.*

- **[SECURITY]** SQL Injection vulnerability in `UserSearch`.
- **[CRASH]** Application panics when `input` is empty.
- **[COMPLIANCE]** Hardcoded secrets found in `config.go`.
- **[LOGIC]** `calculateTotal` returns negative values for valid inputs.

## ‚ö†Ô∏è Technical Debt & Risks (Plan Impact)
*Functional but problematic code. Lisa should log these in `PLAN.md` to be addressed 
in the current or next milestone.*

- **[PERF]** `UserList` endpoint makes N+1 DB queries; will fail at scale.
- **[MAINT]** `AuthService` logic is duplicated in `ProfileService`.
- **[TEST]** Test coverage for error handling is below 80%.
- **[DOCS]** API documentation does not match implementation.

## üß™ Verification & Reproduction ("How to Break It")
*Specific commands or steps Ralph can use to reproduce the failure and verify the fix.*

```bash
# Triggers the crash
curl -X POST http://localhost:8080/api/search -d '{"query": ""}'
```

## üß† Strategic Observations
*High-level feedback on scope, complexity, or architecture for Lisa.*
- "The current implementation of feature X is more complex than the original estimate."
- "Recommend splitting the 'Reporting' module into a separate Epic."
```

---

## üè∑Ô∏è Tagging Standards

Bart uses **Conventional Comments** style tags to categorize issues.

| Tag | Meaning | Action for Lisa/Ralph |
| :--- | :--- | :--- |
| **[SECURITY]** | Vulnerability / Exploit | **BLOCKER**: Must fix before merge. |
| **[CRASH]** | Panic / Fatal Error | **BLOCKER**: Must fix before merge. |
| **[LOGIC]** | Incorrect Behavior | **BLOCKER**: Must fix before merge. |
| **[PERF]** | Performance Issue | **Conditional**: Fix now if severe, else backlog. |
| **[MAINT]** | Maintainability / Clean Code | **Debt**: Add to `PLAN.md` for refactoring. |
| **[TEST]** | Test Quality / Coverage | **Debt**: Add to `PLAN.md` to improve confidence. |
| **[DOCS]** | Documentation | **Debt**: Update docs before release. |

## üö¶ Status Definitions

1.  **BLOCKED (üî¥)**:
    *   **Criteria**: Contains [SECURITY], [CRASH], or critical [LOGIC] issues.
    *   **Lisa's Action**: Halt current track. Move Blockers to top of `TODO.md`.

2.  **CONDITIONAL (üü°)**:
    *   **Criteria**: Functional, but contains significant [PERF] or [MAINT] issues that might bite later.
    *   **Lisa's Action**: Schedule fixes in `PLAN.md` (Backlog or Next Milestone). Merge allowed only with waivers.

3.  **APPROVED (üü¢)**:
    *   **Criteria**: No critical issues. Minor [NIT] or [DOCS] findings only.
    *   **Lisa's Action**: Proceed to Merge/Release.
